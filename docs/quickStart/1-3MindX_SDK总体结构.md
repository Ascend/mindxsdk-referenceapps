# MindX SDK总体结构

![image.png](img/1623748262037.png 'image.png')

## mxManufacture & mxVision特性介绍

关键特性：
- 配置文件快速构建AI推理业务。
- 插件化开发模式，将整个推理流程“插件化”，每个插件提供一种功能，通过组装不同的插件，灵活适配推理业务流程。
- 提供丰富的插件库，用户可根据业务需求组合Jpeg解码、抠图、缩放、模型推理、数据序列化等插件。
- 基于Ascend Computing Language(ACL)，提供常用功能的高级API，如模型推理、解码、预处理等，简化Ascend芯片应用开发。
- 支持自定义插件开发，用户可快速地将自己的业务逻辑封装成插件，打造自己的应用插件。
![image.png](img/1623748753909.png 'image.png')

## 典型的推理业务
如下图所示，为典型的推理业务流程参考。用户通过调用API，向推理业务发送图像或视频，等待推理服务返回目标的坐标（目标检测插件输出）和图像分类结果。用于展示结果的图形界面，需要用户自行开发。
典型推理业务流程如图中人体特征识别所示，先通过目标检测获取目标坐标，然后通过图像分类识别人体属性。流程中有两次图像缩放的操作，两者主要区别在于设置的缩放宽高参数不同。
![image.png](img/1623748862495.png 'image.png')

## mxManufacture & mxVision基本概念
通过Stream配置文件，Stream manager可识别需要构建的Element，以及它们之间的连接关系，并启动业务流程。Stream manager对外提供接口，用于向Stream发送数据和获取结果，令用户实现业务对接。
Element表示业务流程中的基础模块，通过Element的串接构建Stream。Buffer用于内部挂载解码后的视频/图像数据，是Element之间传递的数据结构，同时也可挂载元数据（Metadata），用于存放结构化数据（如目标检测结果）或过程数据（如缩放后的图像）。

![image.png](img/1623757765892.png 'image.png')

# AI应用开发与运行步骤
## 运行推理业务步骤
其中插件开发和后处理模块开发输入为SDK高级特性，用户可以视情况选择，如有需要可以参见用户指南8.2章节 插件开发介绍。
![image.png](img/1623758745148.png 'image.png')


### 步骤1  确定业务流程-匹配插件
根据业务功能将业务流程进行模块化，再选择合适的插件匹配业务功能。
![image.png](img/1623749109243.png 'image.png')

### 步骤2  流程编排
下次为流程配置文件pipeline，根据设计的业务流程匹配对应的插件，流程搭建包含（业务流名称，元件名称，插件名称，元件属性，下游元件名称）。
![image.png](img/1623749180481.png 'image.png') 
![image.png](img/1623749192860.png 'image.png')

### 步骤3  业务集成
通过调用业务流管理的API（MxStreamManager），先进行初始化，再加载业务流配置文件（*.pipeline）创建Stream - 根据StreamName往指定Stream获取输出数据 - 最后销毁Stream。

### 步骤4  剩余步骤
编译 - 配置日志参数 - 运行脚本 - 打包部署 - 启动业务（请参见用户指南5.5章节编译与运行应用工程）